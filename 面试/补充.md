### **1、在SQL备份时应该先开启什么服务？**

答：要开启 SQLServer Agent，SQL Server Agent代理服务,是sql server的一个标准服务,作用是代理执行所有sql的自动化任务,以及数据库事务性复制等无人值守bai任务。 这种服务主要是用于在设定的时间备份、复制数据,以及在自动执行调度表上设置的其他项目。

---



### **2、存储过程与函数的区别？**

答：1.一般来说，[存储过程](https://so.csdn.net/so/search?q=存储过程&spm=1001.2101.3001.7020)实现的功能要复杂一点，而函数的实现的功能针对性比较强。

　　2.对于存储过程来说可以返回参数(output)，而函数只能返回值或者表对象。

　　3.存储过程一般是作为一个独立的部分来执行，而函数可以作为查询语句的一个部分来调用，由于函数可以返回一个表对象，因此它可以在查询语句中位于FROM关键字的后面。



简单的一个例子，定义存储过程：

```sql
create proc usp_StudentByGenderAge
　　@gender nvarchar(10) [='男'],
　　@age int [=30]
　　as
　　select * from MyStudent where FGender=@gender and FAge=@age
```

执行存储过程：

**Situation One(调用默认的参数):**

```sql
exec usp_StudentByGenderAge
```

**Situation Two(调用自己指定的参数):**

```sql
exec usp_StudentByGenderAge '女',50
```

**或者指定变量名**    

```sql
exec usp_StudentByGenderAge @age=50,@gender='女'
```

---





### **3、MySQL的热备-冷备-温备**

答：根据备份的方法（是否需要数据库离线）可以将备份分为： 热备（Hot Backup） 冷备（Cold Backup） 温备（Warm Backup）

**热备**：在数据库运行状态下进行备份，备份时不需要停止数据库的服务。但是，由于备份时需要访问数据库文件，因此备份过程中可能会影响数据库的正常运行。这种方式在 MySQL 官方手册中称为 Online Backup （在线备份）。

冷备：在关闭数据库的情况下进行备份。这种备份方式不影响数据库的正常运行，但是需要停止数据库的服务。适用于小型数据量、备份频繁及服务器空闲时进行备份。这种方式在 MySQL 官方手 册中称为 Offline Backup（离线备份）。

**温备**份同样是在数据库运行中进行的，但是会对当前数据库的操作有所影响，备份时 仅支持读操作，不支持写操作。

---





### 4、逻辑备份-物理备份

答：**逻辑备份**:是指备份出的文件内容是可读的，一般是文本内容。 内容一般是由一条条 SQL 语句，或者是表内实际数据组成。如 [mysqldump](https://so.csdn.net/so/search?q=mysqldump&spm=1001.2101.3001.7020) 和 SELECT * INTO OUTFILE 的方法。这类方法的好处是可以观察导出文件的内容，一 般适用于数据库的升级、迁移等工作。但其缺点是恢复的时间较长。逻辑备份可以将数据转换为其他数据库的格式，如SQL Server、Oracle等。因此，逻辑备份具有更好的平台兼容性。

**物理备份**:指复制数据库的物理文件，备份数据的过程就是直接复制数据库底层的数据，包括数据文件、日志文件、控制文件等。裸文件备份的数据无需进行转换，因此备份和恢复操作速度快。但裸文件备份只能在同一平台之间进行[数据恢复](https://so.csdn.net/so/search?q=数据恢复&spm=1001.2101.3001.7020)，跨平台需要进行格式转换。

---



### 5、**完全备份-增量备份-差异备份**

答：

**完全备份**：备份所有的数据文件，包括数据文件、日志文件、控制文件。这种备份方式最为安全，但是需要的时间和空间都比较大。

第一次备份：------

第二次备份：---------

第三次备份：------------    

**增量备份**：只备份自上次完全备份或增量备份以来发生过的数据变化。因此，增量备份所需的时间和空间都比完全备份少，但是恢复的时间和难度都比完全备份要大。

第一次备份：------

第二次备份：    ---

第三次备份：    ------    

**差异备份**：备份最近一次完全备份以来发生的数据变化。与增量备份相比，差异备份需要备份的数据量少，但是恢复时需要进行多次增量备份的合并，因此恢复的时间和难度也比较大。

第一次备份：------

第二次备份：    ---

第三次备份：      --- 

---



### 6、备份数据库

```sql
mysqldump -h127.0.0.1 -P3306 -utest -p123456 student > I:\sql\2021-07-27_14-19-14\student.sql
```

还原

```sql
mysql -h127.0.0.1 -P3306 -utest -p123456 student < 2021-07-27_14-19-04\student.sql
```

**Docker备份**

```sql
docker exec -i 111122223333 /bin/bash -c 'mysqldump -utest -p123456 ${dbName} 1>> ${dir}/${dbName}.sql 2>> /root/backupDB/log/${dateBackup}.log'
```

**开启定制任务**