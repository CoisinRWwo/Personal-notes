## 数据库系统概述

---



**客观世界的三大要素：信息，能源，材料**



**数据加工**经历了**现实世界、信息世界**（概念信息、ER图）和**计算机世界**。



**数据库（DB）**是储存在计算机内、**有组织、 可共享、（的）数据集合**。



数据库用户：

​           **终端用户** （非计算机专业人员使用数据库）

​           **应用程序员** （设计和编制应用程序）

​           **数据库管理员** （负责设计、建立管理和维护数据库以及协调用户对数据库要求的个人或工作团队）





数据库技术的产出发展：

​				**人工管理阶段**：数据不保存，不共享，无独立性，无专用软件管理数据

​                **文件系统阶段**：数据以文件形式长期保存，由文件系统管理数据，程序与数据间有一定的独立性

​                **数据库系统阶段**：数据结构化，共享性高、冗余度低，独立性高，有统一的数据控制功能



**数据库系统（DBS）（范围最大）：数据库、数据库用户、计算机硬件系统、计算机软件系统**



**操作系统（OS）是位于用户和数据库之间的桥梁。**



**DB：数据库   DBA ：数据库管理员   DBMS：数据库管理系统（核心）**



数据库管理系统（DBMS）：

​					 **数据的安全性控制**：

​                                    控制非法操作

​                                    通过**权限控制（DCL）**、数据控制

​                                    **DCL ：grant（授权）、revoke（收回）**

​                     **数据的完整性控制**：

​                                    1.**实体完整性**    主键的引用

​                                    2.**参照完整性**    外键的引用

​                                    3.**用户自定义完整性**      定义数据类型，长度等。

​                     **并发控制**：

​                                    保证数据的一致性

​                                    封锁技术（同一时间只允许一人访问）

​                     **数据恢复**：

​                                    数据文件 .mdf

​                                    日志文件（记录更新操作）.ldf



SQL 是**结构化查询语言**。



***DDL数据定义语言：create 、alter（修改结构）、drop（删除结构）***

***DML数据操作语言：select 、 update（修改数据）、delete（删除数据）、insert***

***DCL数据控制语言：grant（授权）、revoke（回收）***

 **(需全部大写)**



SQL 分为 **数据查询、数据定义、数据操作、数据控制** 四种操作



**数据模型的组成要素：数据结构、数据操作、数据的约束条件**



**逻辑(数据结构)模型**主要包括 **层次模型(1:n树状图)、**

​                                              **网状模型(m:n 网状图)、**

​                                              **关系模型(二维表)、**

​                                              **面向对象模型等**



数据库系统：Foxpro、Access、Oracle、Sql Server、Informix、Sybase、DB2、mysql



数据库系统的发展：

​                第一代：格式化数据模型（层次数据模型和网状数据模型）

​                **第二代：关系数据模型（发展到了第二代）**

​                第三代：面向对象数据模型

---



## 常用同义词



**表**：关系，关系模式

**行**：记录，元组

**列**：字段，属性，目，度

**主键**：主码，关键字，关系字



----



## 数据库系统的三级模式结构



![image-20211025150006001](C:\Users\Admin\AppData\Roaming\Typora\typora-user-images\image-20211025150006001.png)



---



## 关系数据库



域是一组具有相同数据类型的值的集合，又称为值域。

笛卡尔积 是一个二维表。



关系的性质：

​          			**每一列中的分量必须来自同一个域，必须是同一类型的数据**

　　　　　　**不同的例可来自同一域，每一列称为属性，不同的属性必须有不同的名字**

　　　　　　**列的顺序可以任意交换**

　　　　　　**关系中元组的顺序可任意**

　　　　　　**关系中每一分量必须是不可分的数据项。**



关系的描述称为　关系模式

　　　　　　　　R(U,D,DOM,F)

　　　　　　　　**R－关系名**

　　　　　　　　**U－属性名集合**

　　　　　　　　D－属性所来自的域（列的取值方位，数据类型）

　　　　　　　　DOM－属性向域的映像集合

　　　　　　　　F－属性间数据的依赖关系集合



能**唯一标识**关系(表)中元组(行)的一个**属性（列）或属性集**，称为**候选键**。

**主键(Primary Key)（主码、主关系键、关系键、关系字）**从多个候选键中选择一个作为查询或删除元组的操作变量，被选用的候选键成为**主关系键**。

每个关系有且只有一个主键

包含在主关系键中的各个属性称为主属性。

外部关系键（外键）



---



## 等值连接与自然连接的区别和联系



区别：

等值连接不要求两个关系中进行比较的分量是相同的属性组，而只要可以进行相等比较即可，是从行进行的一种运算。

而自然连接要求两个关系中进行比较的分量必须是相同的属性组，并且在结果中把重复的属性列去掉，是从行和列进行的一种运算。

 

联系：

等值连接是关系的广义笛卡尔积的子集。自然连接是一种特殊的等值连接。即两者都是两个关系连接之后的产物。



---



## 关系代数的分类及其运算符



- 关系代数是一种抽象的查询语言

- 关系运算分为 **关系代数 关系演算**

- 关系代数的运算对象与运算结果都是关系

- 平均值：**AVG 总和：SUM 计数：COUNT 最大最小：MAX MIN**

- 关系代数运算符

  ​		**1.集合运算符**

  ​           ***∪ 并集 属于R或属于S***

  ​			***∩ 交集 属于R且属于S***

  ​           ***— 差集 属于R不属于S （交和差是等价的）***

  ​           ***× 笛卡尔积 （最复杂 花时间 规模最大 ）*** 

​               **2.关系运算符**

​					***α 选择 （行）***

​           		***π 投影 （列）***

​           		***∞ 连接***

​           		***÷ 除法***

​                3.比较运算符

​					![1](C:\Users\Admin\OneDrive\MarkDown\DataBase(SQLServer)\img\1.png)

​				4.逻辑运算符

​					![2](C:\Users\Admin\OneDrive\MarkDown\DataBase(SQLServer)\img\2.png)

​					与  或  非



**大题 关系代数表达式 ：**

**选择：α dept = ‘计算机’（S）**

​           **α（sal>100)^(sex'男')（T）**

**投影：π()**

**结合：π(α( ∞))**

**例：查询讲授C5课程的教师号：π TNo(αCNo='C5'(TC))**



---



## SQL语言



大型数据库：Sybase、INFORMIX、SQL Server、Oracle、DB2、INGRES、MySQL

小型数据库：Foxpro、Access



SQL的主要特点：

**1.SQL语言是类似英语的自然语言，简洁易用。**

**2.SQL语言是一种非过程语言。（面向过程）**

**3.SQL语言是一种面向集合的语言。**

**4.SQL语言既是自含式语言，又是嵌入式语言。**

**5.SQL语言具有数据查询、数据定义、数据操作、数据控制四种功能。**



主要数据文件（.mdf 、**只能有一个**）+ 次要数据文件（.ndf 、**可以有多个**）



一个汉字2个字节

char() 未使用的空间会开辟出来

varchar() 未使用的空间不会开辟出来

nchar() 可直接放中文长度



**用SQL命令创建数据库**

```sql
CREATE TABLE S 
(
 Sno INT PRIMARY KEY,
 Sname VARCHAR(10) NOT NULL,
 Age INT DEFAULT 18,
 Tel CHAR(11) UNIQUE,      (保持唯一性)
 Sex CHAR(2),
 CHECK(Sex='男' OR Sex='女')    (约束只能为男或女)
)
```

**也可以是CHECK (Sex IN ('男','女'))**



**两个属性为主属性建表**

```sql
CREATE TABLE SC 
(
 Snc INT FOREING KEY REFERENCES S(Sno),    (外键)
 Cno INT,
 Score INT,
 PRIMARY KEY(Snc,Cno)
)
```



**数据的完整性：正确性、有效性、相容性。**



**索引的作用：加快查询速度，保证行的唯一性。**

**聚集索引：查询速度快，排列的结果存储在表中只有一个**

**非聚集索引：更新速度快，排列的结果不储存在表中，可以有多个**

**唯一索引：有UNIQUE,自动建立非聚集的唯一索引**

​                   **有PRIMARY KEY ，自动建立聚集索引。**





**用SQL命令创建索引：**

```sql
 CREATE [UNIQUE] [CLUSTERED] INDEX (表名) ON
```

注意：（1）改变表中的数据（如增加或删除记录），索引将自动更新；

​     	  （2）索引建立后，在查询使用该列时，系统将自动使用索引查询。

​     	  （3）索引数目无限制，但索引越多，更新数据的速度越慢，对于仅用于查询的表可多建索引，对于数据更新频繁的表则因少建索引。





**数据查询：**

```sql
  SELECT (DISTINCT)<去掉重复值> --- FROM --- WHERE --- GROUP BY --- HAVING ---
```

**常用的比较运算符：**

![3](C:\Users\Admin\OneDrive\MarkDown\DataBase(SQLServer)\img\3.png)



**多表结合**

```sql
SELECT T.Tno , TN , Cno FROM T , TC WHERE T.TNo=TC.TNo AND TN=''
```



子查询（嵌套查询）

![4](C:\Users\Admin\OneDrive\MarkDown\DataBase(SQLServer)\img\4.png)

先执行括号里的  使用**ANY或ALL**（前者取其中一位，后者取全部）



UNION操作是将来自不同查询的数据组合起来，形成一个具有综合信息的查询结构。UNIONAL



**用SQL命令添加数据**

```sql
INSERT INTO <表名> （<列名>，<列名>）VALUES ( <值> , <值>)
```



**用SQL命令修改数据**

```sql
UPDATe <表名> SET <列名>=<表达式> [WHERE] 
```

**加上WHERE为修改符合条件的行，不加则是全部**

 

**用SQL命令删除数据**

```sql
DELETE FROM <表名> [WHERE <条件>]  
```

**加上WHERE为删除符合条件的行，不加则是全部**



**创建视图**

```sql
CREATE VIEW <视图名>[（<视图列表>）] AS 子查询
```

![5](C:\Users\Admin\OneDrive\MarkDown\DataBase(SQLServer)\img\5.png)

修改视图 ***ALTER VIEW***

删除视图 ***DROP VIEW***



**视图做出修改，表可能会做出变动。**

**视图的优点：利于数据保密、简化查询操作，保证数据的逻辑独立性。**



---



## 函数依赖



- **定义**

  假设在关系R中，X、Y为R的两个属性,如果每个X值只有一个Y值与之对应,则称属性Y**函数依赖**于属性X;或称属性X唯一确定属性Y,记作X一Y。

- 如果Y不函数依赖于X，记作X→Y。
- 如果X一Y,同时X不包含Y，则称X一Y是**非平凡函数依赖**。
- 如果X包含Y,则称X→Y是**平凡函数依赖**。



- 函数依赖的基本性质有 **投影性 扩张性 合并性 分解性**



- 函数依赖是规范化理论的依据和规范化程度的准则。



- **函数依赖的类型**

  ​	**完全函数依赖**

  ​			在关系模式中，如果X一Y，并且对于X的任何一个真子集X/都有X一Y，则称Y完全函数依赖于X，记作XY。

  ​	**部分函数依赖**

  ​			若X一Y,但Y不完全函数依赖于X，则称Y部分函数依赖于X,记作X Y。

  ​	**传递函数依赖**

  ​			在关系模式中,如果X一Y,Y一Z,且Y X,Z Y,Y一X，则称Z传递函数依赖于X。



- **关系模式的规范化**

  ​	存在的问题:

  ​			**1、数据冗余**

  ​			**2，插入异常**

  ​			**3、删除异常**

  ​			**4、更新异常**



---



## 关系数据库的规范化过程



- 规范化的基本思想

  消除关系模式中的数据冗余,消除数据依赖中的合适的部分,解决数据插入、删除时发生的异常象。



- 范式的定义

  关系数据库的规范化过程中为不同程度的规范化!求设立的不同标准,称为范式。

  

- 范式的种类

  第一范式(INF）、第二范式(2NF）、第三范式（3NF) 、BC范式(BCNF）第四范式（4NF），五范式（5NT）

  

- 关系数据库的规范化过程各种范之间存在联系:

  

- 某一系模式R为第n范式，可简记为REnNF。

  

- 一个低一级范式的关系模式,通过**模式分解**可以转换为若干个高一级范式的关系模式的集合,这种过程就叫**规范化**。





**第一范式（1 NF)**

- 定义

  如果一个关系模式R中**无重复属性**,每个属性都是不可再分的基本致据项,则R=1NF。

- 说明

  第一范式是对关系模式的最起码的要求。不满足第一范式的数据库模式不能称为关系数据库。

  但是满足第一范式的关系模式并不一定是一个好的关系模式



**第二范式（2NF）**

- 定义

  若RE1NF、且每一个**非主属性完全函数依赖**于候选键,则RE2NF。

  

 

**第三范式(3NF)**

- 定义

  若RE2NF,且任**何非主属性不传递函数依赖**于任何候选键,则RE3NF。



BCNF范式

- 在关系中，每一个函数依赖均满足：

​       若x—>y ，且y不在x内，且 x包含主码，就是BCNF

 

规范化中遵循的原则

- 关系分解时要受到数据间的相互约束,在分解过程中要注意以下两条原则

  **无损连接性**

  **函数依赖保持性**

  

- 关系分解必须从实际出发,并非范式等级越高越好。



---



## 数据库安全性



SQL Server的身份验证模式：**Windows身份验证模式、混合身份验证模式**

 

**数据的完整性：正确性、有效性、相容性。**

 

数据库的完整性是指防止合法用户使用数据库时向数据库中加入**不符合语义**的数据

 

事务的特征：**原子性、一致性、隔离性、持久性**。



---



## 数据库设计



- 数据库设计的任务  

  ​    

  数据库设计是指根据用户需求弹指数据库结构的过程



- 数据库设计的内容

​    **结构设计：概念设计（ER） 逻辑设计（规范化）  物理设计（存储方案）**

​    **行为设计：应用程序的设计**



- 数据库设计分为6个阶段

  **1.系统需求分析阶段（最重要的阶段）**

  **2.概念结构设计阶段**

  **3.逻辑结构分析阶段**

  **4.物理结构分析阶段**

  **5.数据库实验阶段**

  **6.数据库运行与维护阶段**



- 数据库设计的特点 

​    现代数据库的设计特点是强调设计与行为设计相结合，是一种“分度探寻，逐步求精”的过程



- 需求分析的任务（做什么 最重要 最花时间 麻烦 复杂）

     **调查分析用户活动**

     收集和分析需求数据，确定系统边界

     编写系统分析报告



**数据流图（DFD）和数据字典(DD)是需求分析的时候会用到的工具**



- 数据字典

   数据字典是对系统中**数据的详细描述**，是各类数据结构和属性的清单。

   在需求分析阶段，它通常包含以下五部分内容： **数据项**

​                                       										**数据结构**

​                                       										**数据流**

​                                     		  								**数据存储**

​                                       										**处理过程**



- 概念结构设计 = ER图 对用户的需求的总结和分析



- 冲突分类

   **属性冲突   命名冲突   结构冲突**



- 物理结构设计

     	 数据库的物理结构设计可分为两部：

​          1.确定物理结构，在关系数据库中主要指存取方法和存储结构

​          2.评价物理结构，评价的重点是时间和空间效率



- 模式改进：**合并、分解**



- 确定物理结构，存储记录结构的设计

聚集

索引

